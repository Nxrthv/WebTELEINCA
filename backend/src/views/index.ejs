<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
      @layer utilities {
        .clip-path-slant {
          clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
        }
        .text-shadow {
          text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>

  <body class="bg-gray-50">
    <%- include('reusable/navigation') %>

    <!-- Encabezado -->
    <section
      class="bg-gradient-to-br from-primary-700 via-primary-600 to-primary-800 text-white py-16 clip-path-slant relative overflow-hidden"
    >
      <div class="absolute inset-0 opacity-10">
        <div
          class="absolute top-0 left-0 w-40 h-40 bg-secondary-400 rounded-full filter blur-3xl"
        ></div>
        <div
          class="absolute bottom-0 right-0 w-60 h-60 bg-secondary-300 rounded-full filter blur-3xl"
        ></div>
        <div
          class="absolute top-1/2 left-1/3 w-40 h-40 bg-primary-300 rounded-full filter blur-3xl"
        ></div>
      </div>

      <div class="container mx-auto px-4 relative z-10">
        <div class="max-w-3xl mx-auto text-center">
          <h1 class="text-4xl md:text-5xl font-bold mb-6 text-shadow">
            Descubre Nuestros Planes
          </h1>
          <p class="text-lg md:text-xl mb-8 text-gray-100">
            Encuentra el plan perfecto para ti con la mejor tecnología y al
            mejor precio.
          </p>

          <div class="flex flex-wrap justify-center gap-4 mb-8">
            <a
              href="#internet"
              class="bg-white text-primary-700 hover:bg-gray-100 px-6 py-3 rounded-lg font-medium transition-all transform hover:-translate-y-1 hover:shadow-lg"
            >
              <i class="fas fa-wifi mr-2"></i> Planes de Internet
            </a>
            <a
              href="#cable"
              class="bg-white text-primary-700 hover:bg-gray-100 px-6 py-3 rounded-lg font-medium transition-all transform hover:-translate-y-1 hover:shadow-lg"
            >
              <i class="fas fa-tv mr-2"></i> Planes de TV Cable
            </a>
            <a
              href="#duo"
              class="bg-white text-primary-700 hover:bg-gray-100 px-6 py-3 rounded-lg font-medium transition-all transform hover:-translate-y-1 hover:shadow-lg"
            >
              <i class="fas fa-box mr-2"></i> Paquetes Duo
            </a>
          </div>

          <div class="text-sm text-gray-200">
            <p>
              Todos nuestros planes incluyen instalación gratuita y soporte
              técnico 24/7
            </p>
          </div>
        </div>
      </div>

      <div class="absolute bottom-0 left-0 w-full h-16 bg-gray-50"></div>
    </section>

    <!-- Filtrar -->
    <section class="py-8 bg-white shadow-md sticky z-40">
      <div class="container mx-auto px-4">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <div class="flex flex-wrap items-center gap-4">
            <h2 class="text-xl font-bold text-gray-800">Filtrar por:</h2>

            <div class="flex flex-wrap gap-2">
              <button
                class="filter-btn active bg-primary-100 text-primary-800 hover:bg-primary-200 px-4 py-2 rounded-md text-sm font-medium transition-colors"
                data-filter="all"
              >
                Todos
              </button>
              <button
                class="filter-btn bg-gray-100 text-gray-700 hover:bg-primary-100 hover:text-primary-800 px-4 py-2 rounded-md text-sm font-medium transition-colors"
                data-filter="Internet"
              >
                Internet
              </button>
              <button
                class="filter-btn bg-gray-100 text-gray-700 hover:bg-primary-100 hover:text-primary-800 px-4 py-2 rounded-md text-sm font-medium transition-colors"
                data-filter="Tv Digital"
              >
                TV Cable
              </button>
              <button
                class="filter-btn bg-gray-100 text-gray-700 hover:bg-primary-100 hover:text-primary-800 px-4 py-2 rounded-md text-sm font-medium transition-colors"
                data-filter="Dúos"
              >
                Paquetes Dúo
              </button>
            </div>
          </div>

          <div class="flex items-center gap-2">
            <label for="sort" class="text-sm font-medium text-gray-700"
              >Ordenar por:</label
            >
            <select
              id="sort"
              class="bg-gray-100 border border-gray-300 text-gray-700 text-sm rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            >
              <option value="price-asc">Precio: Menor a Mayor</option>
              <option value="price-desc">Precio: Mayor a Menor</option>
              <option value="speed-asc">Velocidad: Menor a Mayor</option>
              <option value="speed-desc">Velocidad: Mayor a Menor</option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <!-- Duo Section -->
    <section id="duo" class="planes py-16 bg-gray-50" data-category="Dúos">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <span
            class="inline-block bg-primary-100 text-primary-800 text-sm font-medium px-3 py-1 rounded-full mb-3"
            >PAQUETES DUO</span
          >
          <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            Paquetes Duo: Internet + TV Cable
          </h2>
          <p class="text-lg text-gray-600 max-w-3xl mx-auto">
            Combina servicios y ahorra con nuestros paquetes especiales
            diseñados para ti.
          </p>
        </div>

        <div
          id="duo-fibra"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6 plan-container"
        ></div>
      </div>
    </section>

    <!-- Internet Section -->
    <section
      id="internet"
      class="planes py-16 bg-gray-50"
      data-category="Internet"
    >
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <span
            class="inline-block bg-primary-100 text-primary-800 text-sm font-medium px-3 py-1 rounded-full mb-3"
            >INTERNET</span
          >
          <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            Planes de Internet de Alta Velocidad
          </h2>
          <p class="text-lg text-gray-600 max-w-3xl mx-auto">
            Navega, transmite y descarga a velocidades increíbles con nuestra
            conexión de fibra óptica de última generación.
          </p>
        </div>

        <div
          id="planesInternet"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6 plan-container"
        ></div>
      </div>
    </section>

    <!-- Internet Cable -->
    <section
      id="cable"
      class="planes py-16 bg-gray-50"
      data-category="Tv Digital"
    >
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <span
            class="inline-block bg-primary-100 text-primary-800 text-sm font-medium px-3 py-1 rounded-full mb-3"
            >TV CABLE</span
          >
          <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
            Planes de TV Cable Premium
          </h2>
          <p class="text-lg text-gray-600 max-w-3xl mx-auto">
            Disfruta de cientos de canales en HD y contenido exclusivo para toda
            la familia.
          </p>
        </div>

        <div
          id="planesCable"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6 plan-container"
        ></div>
      </div>
    </section>

    <!-- Payment Section -->
    <section class="bg-gray-100 py-12">
      <div class="flex flex-wrap items-center">
        <div class="w-full md:w-1/3 mb-8 md:mb-0 justify-center">
          <img
            src="/resources/Images/pagoatiempo0.png"
            alt="Pago a tiempo"
            class="mx-auto w-64 md:w-80"
            style="filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.507))"
          />
          <p class="text-3xl font-bold text-center text-green-500 mt-4">
            Paga antes del
          </p>
          <p
            class="text-2xl w-80 mx-auto font-bold text-center bg-green-500 text-white py-2 rounded-full mt-2"
          >
            Ultimo día de cada Mes
          </p>
          <p class="text-3xl font-bold text-center text-green-500 mt-4">
            y obten tu
          </p>
          <div
            class="bg-green-500 w-40 text-white text-center py-4 rounded-3xl mt-4 mx-auto max-w-sm"
            style="border-top-right-radius: 5px; border-bottom-left-radius: 5px"
          >
            <p class="text-2xl font-bold">Descuento</p>
            <p class="text-2xl font-bold">
              del <span class="text-5xl">5%</span>
            </p>
          </div>
        </div>
        <div class="w-full md:w-2/3 text-center md:pr-8">
          <h2 class="text-3xl font-bold mb-4">
            Paga tus Servicios sin Necesidad de Salir de Casa
          </h2>
          <p class="mb-8">
            Selecciona el metodo de pago que prefieras y conoce los pasos para
            pagar tu recibo en las diferentes Apps. Paga desde la tranquilidad
            de tu hogar y sin comisiones.
          </p>
          <div class="flex justify-center items-center gap-8">
            <img
              src="/Resources/Images/yape.png"
              alt="Yape"
              class="w-20 mt-5 h-20 object-contain hover:scale-110 transition-all"
            />
            <img
              src="/Resources/Images/bbva.png"
              alt="BBVA"
              class="w-32 h-20 object-contain hover:scale-110 transition-all"
            />
            <img
              src="/Resources/Images/bcplogo.png"
              alt="BCP"
              class="w-32 h-20 object-contain hover:scale-110 transition-all"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- Soporte Section -->
    <section
      class="py-16 bg-gradient-to-br from-primary-700 to-primary-900 text-white"
    >
      <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-6">
          ¿Necesitas ayuda para elegir el plan perfecto?
        </h2>
        <p class="text-lg mb-8 max-w-3xl mx-auto">
          Nuestros asesores están listos para ayudarte a encontrar la mejor
          solución para tus necesidades de conectividad.
        </p>
        <div class="flex flex-wrap justify-center gap-4">
          <a
            href="#"
            class="bg-white text-primary-700 hover:bg-gray-100 px-6 py-3 rounded-lg font-medium transition-all transform hover:-translate-y-1 hover:shadow-lg"
          >
            <i class="fas fa-phone-alt mr-2"></i> Llámanos ahora
          </a>
          <a
            href="#"
            class="bg-secondary-500 hover:bg-secondary-600 text-primary-900 px-6 py-3 rounded-lg font-medium transition-all transform hover:-translate-y-1 hover:shadow-lg"
          >
            <i class="fas fa-calendar-alt mr-2"></i> Agenda una cita
          </a>
        </div>
      </div>
    </section>

    <!-- Floating Contact Buttons -->
    <!-- <div class="fixed bottom-5 right-5 flex flex-col gap-2">
        <a href="https://wa.me/51962624690?text=Hola, tengo una consulta." target="_blank"
           class="bg-green-500 text-white px-4 py-2 rounded-full flex items-center hover:bg-green-600 transition duration-300">
            <i class="bi bi-whatsapp mr-2"></i> WhatsApp
        </a>
        <a href="tel:062-514798"
           class="bg-blue-500 text-white px-4 py-2 rounded-full flex items-center hover:bg-blue-600 transition duration-300">
            <i class="bi bi-telephone-outbound mr-2"></i> Llamanos
        </a>
    </div> -->

    <!-- Chatbot Button -->
    <button
      id="chatbot-button"
      class="fixed bottom-6 right-6 bg-secondary-500 hover:bg-secondary-600 text-primary-900 w-16 h-16 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all z-50 animate-bounce-slow"
    >
      <i class="fas fa-comments text-2xl"></i>
    </button>

    <div
      id="chatbot-modal"
      class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden"
    >
      <div
        class="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-slide-up"
      >
        <div
          class="bg-primary-700 text-white p-4 flex justify-between items-center"
        >
          <div class="flex items-center">
            <div
              class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-primary-700 mr-3"
            >
              <i class="fas fa-robot"></i>
            </div>
            <div>
              <h3 class="font-bold">GaIA - Asistente Virtual</h3>
              <p class="text-xs text-primary-100">Conectado</p>
            </div>
          </div>
          <button
            id="close-chatbot"
            class="text-white hover:text-secondary-300 transition-colors"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="h-96 overflow-y-auto p-4 bg-gray-50" id="chat-messages">
          <div class="flex mb-4">
            <div class="w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center text-white mr-2 flex-shrink-0">
              <i class="fas fa-robot text-xs"></i>
            </div>
            <div class="bg-primary-100 text-primary-900 p-3 rounded-lg rounded-tl-none max-w-xs">
              <p>
                ¡Hola! 👋 Soy GaIA, la asistente virtual de TELEINCA S.A.C.. Estoy aquí para ayudarte con cualquier consulta sobre tu servicio, resolver dudas o asesorarte en la contratación de un plan. ¿En qué puedo ayudarte hoy? 😊
              </p>
            </div>
          </div>
        </div>

        <div class="p-4 border-t">
          <form id="chat-form" class="flex">
            <input
              type="text"
              id="chat-input"
              placeholder="Escribe tu mensaje aquí..."
              class="flex-grow px-4 py-2 bg-gray-100 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
            />
            <button
              type="submit"
              class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-r-lg transition-colors"
            >
              <i class="fas fa-paper-plane"></i>
            </button>
          </form>
          <div class="mt-2 text-xs text-gray-500">
            <p>Puedes preguntar sobre planes, promociones, cobertura, etc.</p>
          </div>
        </div>
      </div>
    </div>

    <%- include('reusable/footer') %>
  </body>

  <!-- Obtener Dúos -->
  <script>
    async function obtenerPlanesDuo() {
      try {
        const response = await fetch("/api/planes/duos");
        const planes = await response.json();

        const contenedor = document.getElementById("duo-fibra");
        contenedor.innerHTML = "";

        planes.forEach((plan) => {
          const card = document.createElement("div");
          const identificador = plan.popularidad == "Más popular";

          card.innerHTML = `
                        <div class="plan-card cursor-default" data-category="${
                          plan.plan
                        }" data-price="${plan.precio}" data-speed="${
            plan.velocidadmbps
          }">
                            <div class="bg-white rounded-xl overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 h-full flex flex-col relative 
                                ${
                                  identificador
                                    ? "border-2 border-secondary-400"
                                    : "border border-gray-300"
                                }">
                                
                                ${
                                  identificador
                                    ? `
                                <div class="absolute top-0 right-0 bg-secondary-400 text-primary-900 text-xs font-bold px-3 py-1 rounded-bl-lg">
                                    MÁS POPULAR
                                </div>`
                                    : ""
                                }
                                
                                <div class="bg-gradient-to-r from-primary-600 to-primary-800 p-6 text-white text-center">
                                    <h3 class="text-xl font-bold mb-1">${
                                      plan.nombreplan
                                    }</h3>
                                    <div class="text-3xl font-bold mb-1"><span class="text-lg">S/.</span>${
                                      plan.precio
                                    }</div>
                                    <p class="text-primary-100 text-sm">por mes</p>
                                </div>
                                
                                <div class="p-6 flex-grow">
                                    <div class="mb-6">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="font-medium text-gray-700">Internet:</span>
                                            <span class="font-bold text-primary-700">${
                                              plan.velocidadmbps
                                            }</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="font-medium text-gray-700">TV Cable:</span>
                                            <span class="font-bold text-primary-700">${
                                              plan.cantcanales
                                            } Canales</span>
                                        </div>
                                    </div>
                                    
                                    <ul class="space-y-3 mb-6">
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Internet para gaming y streaming 4K</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Canales deportivos y documentales</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Router WiFi 6 de alto rendimiento</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">2 decodificadores HD incluidos</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Mayor ahorro al mes</span>
                                        </li>
                                    </ul>
                                </div>
                                
                                <div class="p-6 pt-0">
                                    <button class="w-full ${
                                      identificador
                                        ? "bg-secondary-500 hover:bg-secondary-600 text-primary-900"
                                        : "bg-primary-600 hover:bg-primary-700 text-white"
                                    } font-medium py-3 px-4 rounded-lg transition-colors">
                                        Contratar ahora
                                    </button>
                                    <button class="w-full mt-2 bg-transparent hover:bg-gray-100 text-primary-700 font-medium py-2 px-4 rounded-lg transition-colors border border-primary-600">
                                        Ver detalles
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
          contenedor.appendChild(card);
        });
      } catch (error) {
        console.error("Error obteniendo los planes:", error);
      }
    }

    obtenerPlanesDuo();
  </script>

  <!-- Obtener Internet -->
  <script>
    async function obtenerPlanesInternet() {
      try {
        const response = await fetch("/api/planes/internet");
        const planes = await response.json();

        const contenedor = document.getElementById("planesInternet");
        contenedor.innerHTML = "";

        planes.forEach((plan) => {
          const card = document.createElement("div");
          const identificador = plan.popularidad == "Más popular";

          card.innerHTML = `
                        <div class="plan-card cursor-default" data-category="${
                          plan.plan
                        }" data-price="${plan.precio}" data-speed="${
            plan.velocidadmbps
          }">
                            <div class="bg-white rounded-xl overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 h-full flex flex-col relative 
                                ${
                                  identificador
                                    ? "border-2 border-secondary-400"
                                    : "border border-gray-300"
                                }">
                                
                                ${
                                  identificador
                                    ? `
                                <div class="absolute top-0 right-0 bg-secondary-400 text-primary-900 text-xs font-bold px-3 py-1 rounded-bl-lg">
                                    MÁS POPULAR
                                </div>`
                                    : ""
                                }
                                
                                <div class="bg-primary-600 p-6 text-white text-center">
                                    <h3 class="text-xl font-bold mb-1">${
                                      plan.nombreplan
                                    }</h3>
                                    <div class="text-3xl font-bold mb-1"><span class="text-lg">S/.</span>${
                                      plan.precio
                                    }</div>
                                    <p class="text-primary-100 text-sm">por mes</p>
                                </div>
                                
                                <div class="p-6 flex-grow">
                                    <div class="mb-6">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="font-medium text-gray-700">Internet:</span>
                                            <span class="font-bold text-primary-700">${
                                              plan.velocidadmbps
                                            }</span>
                                        </div>
                                    </div>
                                    
                                    <ul class="space-y-3 mb-6">
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Ideal para navegación y redes sociales</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Hasta 5 dispositivos conectados</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Router WiFi incluido</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                            <span class="text-gray-700">Soporte técnico en horario comercial</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-times text-gray-400 mt-1 mr-2"></i>
                                            <span class="text-gray-400">Sin IP fija</span>
                                        </li>
                                    </ul>
                                </div>
                                
                                <div class="p-6 pt-0">
                                    <button class="w-full ${
                                      identificador
                                        ? "bg-secondary-500 hover:bg-secondary-600 text-primary-900"
                                        : "bg-primary-600 hover:bg-primary-700 text-white"
                                    } font-medium py-3 px-4 rounded-lg transition-colors">
                                        Contratar ahora
                                    </button>
                                    <button class="w-full mt-2 bg-transparent hover:bg-gray-100 text-primary-700 font-medium py-2 px-4 rounded-lg transition-colors border border-primary-600">
                                        Ver detalles
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
          contenedor.appendChild(card);
        });
      } catch (error) {
        console.error("Error obteniendo los planes:", error);
      }
    }

    obtenerPlanesInternet();
  </script>

  <!-- Obtener Tv Cable -->
  <script>
    async function obtenerPlanesCable() {
      try {
        const response = await fetch("/api/planes/cable");
        const planes = await response.json();
        const contenedor = document.getElementById("planesCable");
        contenedor.innerHTML = "";
        planes.forEach((plan) => {
          const card = document.createElement("div");
          const identificador = plan.popularidad == "Más popular";
          card.innerHTML = `
            <div class="plan-card cursor-default" data-category="${
              plan.plan
            }" data-price="${plan.precio}" data-speed="${plan.velocidadmbps}">
                <div class="bg-white rounded-xl overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 h-full flex flex-col relative 
                    ${
                      identificador
                        ? "border-2 border-secondary-400"
                        : "border border-gray-300"
                    }">
                    
                    ${
                      identificador
                        ? `
                    <div class="absolute top-0 right-0 bg-secondary-400 text-primary-900 text-xs font-bold px-3 py-1 rounded-bl-lg">
                        MÁS POPULAR
                    </div>`
                        : ""
                    }
                    
                    <div class="bg-primary-600 p-6 text-white text-center">
                        <h3 class="text-xl font-bold mb-1">${
                          plan.nombreplan
                        }</h3>
                        <div class="text-3xl font-bold mb-1"><span class="text-lg">S/.</span>${
                          plan.precio
                        }</div>
                        <p class="text-primary-100 text-sm">por mes</p>
                    </div>
                    
                    <div class="p-6 flex-grow">
                        <div class="mb-6">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-medium text-gray-700">Internet:</span>
                                <span class="font-bold text-primary-700">${
                                  plan.velocidadmbps
                                }</span>
                            </div>
                        </div>
                        
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-start">
                                <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                <span class="text-gray-700">Todos los canales del plan básico</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                <span class="text-gray-700">Canales de películas y series</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                <span class="text-gray-700">Canales infantiles</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check text-primary-600 mt-1 mr-2"></i>
                                <span class="text-gray-700">1 decodificador HD incluido</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-times text-gray-400 mt-1 mr-2"></i>
                                <span class="text-gray-400">Sin grabación</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="p-6 pt-0">
                        <button class="w-full ${
                          identificador
                            ? "bg-secondary-500 hover:bg-secondary-600 text-primary-900"
                            : "bg-primary-600 hover:bg-primary-700 text-white"
                        } font-medium py-3 px-4 rounded-lg transition-colors">
                            Contratar ahora
                        </button>
                        <button class="w-full mt-2 bg-transparent hover:bg-gray-100 text-primary-700 font-medium py-2 px-4 rounded-lg transition-colors border border-primary-600">
                            Ver detalles
                        </button>
                    </div>
                </div>
            </div>
        `;
          contenedor.appendChild(card);
        });
      } catch (error) {
        console.error("Error obteniendo los planes:", error);
      }
    }
    obtenerPlanesCable();
  </script>

  <script>
    // Filtrar Planes
    const filterButtons = document.querySelectorAll(".filter-btn");
    const planCards = document.querySelectorAll(".planes");
    filterButtons.forEach((button) => {
      button.addEventListener("click", () => {
        // Remove active class from all buttons
        filterButtons.forEach((btn) => {
          btn.classList.remove("active", "bg-primary-100", "text-primary-800");
          btn.classList.add("bg-gray-100", "text-gray-700");
        });
        // Add active class to clicked button
        button.classList.add("active", "bg-primary-100", "text-primary-800");
        button.classList.remove("bg-gray-100", "text-gray-700");
        const filter = button.getAttribute("data-filter");
        planCards.forEach((card) => {
          // Add animation classes
          card.classList.remove("animate-fade-in");
          if (
            filter === "all" ||
            card.getAttribute("data-category") === filter
          ) {
            setTimeout(() => {
              card.style.display = "block";
              card.classList.add("animate-fade-in");
            }, 50);
          } else {
            card.style.display = "none";
          }
        });
      });
    });

    // Sorting Functionality
    const sortSelect = document.getElementById("sort");
    const planContainer = document.querySelectorAll(".plan-container");
    sortSelect.addEventListener("change", () => {
      const sortValue = sortSelect.value;
      const sortDirection = sortValue.split("-")[1];
      const sortBy = sortValue.split("-")[0];
      planContainer.forEach((container) => {
        const cards = Array.from(container.querySelectorAll(".plan-card"));
        cards.sort((a, b) => {
          let valueA, valueB;
          if (sortBy === "price") {
            valueA = parseFloat(a.getAttribute("data-price"));
            valueB = parseFloat(b.getAttribute("data-price"));
          } else if (sortBy === "speed") {
            valueA = parseFloat(a.getAttribute("data-speed"));
            valueB = parseFloat(b.getAttribute("data-speed"));
          }
          if (sortDirection === "asc") {
            return valueA - valueB;
          } else {
            return valueB - valueA;
          }
        });
        // Remove all cards
        cards.forEach((card) => {
          card.remove();
        });
        // Append sorted cards
        cards.forEach((card) => {
          card.classList.add("animate-fade-in");
          container.appendChild(card);
        });
      });
    });

    // Obtener elementos
    const chatbotButton = document.getElementById("chatbot-button");
    const chatbotModal = document.getElementById("chatbot-modal");
    const closeChatbot = document.getElementById("close-chatbot");
    const chatForm = document.getElementById("chat-form");
    const chatInput = document.getElementById("chat-input");
    const chatMessages = document.getElementById("chat-messages");
    if (!chatMessages) {
      console.error(
        "Error: No se encontró el contenedor de mensajes (#chat-messages) en el DOM."
      );
    }

    // Mostrar el chatbot
    chatbotButton.addEventListener("click", () => {
      chatbotModal.classList.remove("hidden");
      setTimeout(() => chatInput.focus(), 300);
    });

    // Cerrar el chatbot
    closeChatbot.addEventListener("click", () => {
      chatbotModal.classList.add("hidden");
    });

    // Cerrar modal al hacer clic fuera del chatbot
    chatbotModal.addEventListener("click", (e) => {
      if (e.target === chatbotModal) {
        chatbotModal.classList.add("hidden");
      }
    });
    
    // Respuestas predefinidas
    const respuestasPredefinidas = {
      internet:
        "Tenemos planes de internet desde 80Mbps hasta 250Mbps. ¿Qué velocidad estás buscando?",
      cable:
        "Nuestros planes de TV Cable incluyen desde 80 hasta +100 canales entre Nacionales e Internacionales. ¿Buscas algún contenido específico como deportes o películas?",
      tv: "Nuestros planes de TV Cable incluyen desde 80 hasta +100 canales entre Nacionales e Internacionales. ¿Buscas algún contenido específico como deportes o películas?",
      duo: "Los paquetes Dúo combinan los planes de Internet y TV Cable con descuentos especiales. ¿Te gustaría conocer nuestro paquete más popular?",
      paquete:
        "Los paquetes Dúo combinan los planes de Internet y TV Cable con descuentos especiales. ¿Te gustaría conocer nuestro paquete más popular?",
      precio:
        "Los precios varían según el plan. Nuestros planes de internet comienzan en S/.40.00, los de TV Cable en S/.30.00 y los paquetes Duo en S/.90.00. ¿Necesitas más detalles sobre algún plan específico?",
      costo:
        "Los precios varían según el plan. Nuestros planes de internet comienzan en S/.40.00, los de TV Cable en S/.30.00 y los paquetes Duo en S/.90.00. ¿Necesitas más detalles sobre algún plan específico?",
      promocion:
        "¡Tenemos varias promociones activas! Por tiempo limitado, ofrecemos instalación gratuita y los 6 primeros meses con el doble de megas de velocidad en nuestros paquetes Dúo. ¿Te interesa algún plan en particular?",
      descuento:
        "¡Tenemos varias promociones activas! Por tiempo limitado, ofrecemos instalación gratuita y los 6 primeros meses con el doble de megas de velocidad en nuestros paquetes Dúo. ¿Te interesa algún plan en particular?",
      quierocontratar:
        "¡Genial!, para eso solo debes seleccionar el paquete que mas te interese y hacer clic en el botón 'Contratar ahora'. Esto te redirigirá al whatsapp de uno de nuestros asesores para que puedas coordinar la contratación de tu plan.",
    };

    // Manejo del envío del formulario del chat
    chatForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const message = chatInput.value.trim();
      if (message === "") return;
      addMessage(message, "user");
      chatInput.value = "";

      const botMessageElement = addMessage("Escribiendo... ⏳", "bot");
      if (!botMessageElement) {
        console.error("Error: No se pudo agregar el mensaje del bot.");
        return;
      }
      // Obtener respuesta predefinida
      let respuesta = obtenerRespuestaPredefinida(message);
      if (!respuesta) {
        // Si no, se consulta a la API
        respuesta = await consultarMagicLoops(message);
      }
      // Devolver Respuesta
      botMessageElement.textContent = respuesta;
    });

    // Función para obtener una respuesta predefinida
    function obtenerRespuestaPredefinida(mensaje) {
      const mensajeLimpio = mensaje.toLowerCase();
      return Object.keys(respuestasPredefinidas).find((key) =>
        mensajeLimpio.includes(key)
      )
        ? respuestasPredefinidas[mensajeLimpio]
        : null;
    }

    // Función para consultar la API de MagicLoops
    async function consultarMagicLoops(prompt) {
      try {
        const response = await fetch(
          `https://magicloops.dev/api/loop/f5299405-10cf-45cf-8631-ec5e56596318/run?prompt=${encodeURIComponent(
            prompt
          )}`
        );
        if (!response.ok) {
          throw new Error(`Error en la API: ${response.status}`);
        }
        const data = await response.json();
        return data.response || "No se obtuvo respuesta.";
      } catch (error) {
        console.error("Error al obtener la respuesta de MagicLoops:", error);
        return "Hubo un problema al obtener la respuesta. Inténtalo de nuevo más tarde.";
      }
    }

    // Agregar mensajes al chat
    function addMessage(message, sender) {
      if (!chatMessages) {
        console.error(
          "Error: No se encontró el contenedor de mensajes en el DOM."
        );
        return null;
      }
      
        const messageDiv = document.createElement("div");
        messageDiv.classList.add("flex", "items-end", "mb-2", "w-full");

        if (sender === "user") {
            messageDiv.classList.add("justify-end"); // Mensaje del usuario
            messageDiv.innerHTML = `
            <div class="flex mb-4">
                <div class="bg-gray-200 text-gray-800 p-3 rounded-lg rounded-tr-none max-w-xs">
                    <p>${message}</p>
                </div>
                <div class="w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center text-white ml-2 flex-shrink-0">
                    <i class="fas fa-user text-xs"></i>
                </div>
            </div>
            `;
        } else {
            messageDiv.classList.add("justify-start"); // Respuesta del bot
            messageDiv.innerHTML = `
            <div class="flex mb-4">
            <div class="w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center text-white mr-2 flex-shrink-0">
              <i class="fas fa-robot text-xs"></i>
            </div>
            <div class="bg-primary-100 text-primary-900 p-3 rounded-lg rounded-tl-none max-w-xs">
              <p>${message}</p>
            </div>
          </div>
            `;
        }

      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;

      return messageDiv;
    }

    // Animar tarjetas al hacer scroll
    function animateOnScroll() {
      const cards = document.querySelectorAll(".plan-card");

      cards.forEach((card, index) => {
        const cardPosition = card.getBoundingClientRect().top;
        const screenPosition = window.innerHeight / 1.3;

        if (cardPosition < screenPosition) {
          setTimeout(() => {
            card.classList.add("animate-fade-in");
          }, index * 100);
        }
      });
    }

    // Iniciar animación al cargar
    window.addEventListener("load", () => {
      animateOnScroll();
    });

    // Animar al hacer scroll
    window.addEventListener("scroll", () => {
      animateOnScroll();
    });
  </script>
</html>